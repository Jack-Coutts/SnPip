{%extends "base.html" %}
{% block title %} Search SNPs {% endblock %}
{% block content %}

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<script>
    $(document).ready(function(){
      $('#download').click(function ()
                              {
          var retContent = [];
          var retString = '';
          $('thead tr').each(function (idx, elem)
                             {
            var elemText = [];
            $(elem).children('th').each(function (childIdx, childElem)
                                        {
              elemText.push($(childElem).text());
            });
            retContent.push(`${elemText.join('\t')}`);
          });

          $('tbody tr').each(function (idx, elem)
                             {
            var elemText = [];
            $(elem).children('td').each(function (childIdx, childElem)
                                        {
              elemText.push($(childElem).text());
            });
            retContent.push(`${elemText.join('\t')}`);
          });
          retString = retContent.join(',\r\n');
          var file = new Blob([retString], {type: 'text/plain'});
          var btn = $('#download');
          btn.attr("href", URL.createObjectURL(file));
          btn.prop("download", "SNP_summary.csv");
        })
    });

</script>



<div class='mt-sm-3'style="margin:auto;max-width:1000px">
    <h2>Search for SNPs</h2>
    <p>Use one of the below parameters to search for single nuceotide polymorphisms
         (SNPs) across populations in the 1000 genomes project.</p>

</div>

<!--
<div class="custom-control custom-checkbox">
  <input type="checkbox" class="custom-control-input" id="customCheck" name="example1">
  <label class="custom-control-label" for="customCheck">Check this custom checkbox</label>
</div>
-->

<form class="example" method="post" action="/search" 
 style="margin:auto;max-width:600px">
   <input type="text" 
           placeholder="Search by SNP name E.g. rs999980" 
           name="snp" class="form-control">
   
   <select name="select" required class="custom-select" >
       <option disabled selected value="">Search by</option>
       <option value="SNP Name">SNP Name</option>
       <option value="Gene Name">Gene Name</option>
       <option value="Location">Location</option>
   </select>

    <div class='form-control' required>
  
      <label>Populations: </label>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="inlineCheckbox1" name='subpop' value="GBR" checked >
        <label class="form-check-label" for="inlineCheckbox1">Great Britain</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="inlineCheckbox2" name='subpop' value="CHB" checked>
        <label class="form-check-label" for="inlineCheckbox2">China</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="inlineCheckbox3" name='subpop' value="BEB" checked >
        <label class="form-check-label" for="inlineCheckbox3">Bengali</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="inlineCheckbox4" name='subpop' value="PEL" checked >
        <label class="form-check-label" for="inlineCheckbox4">Peru</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" id="inlineCheckbox5" name='subpop' value="ESN" checked>
        <label class="form-check-label" for="inlineCheckbox5">Nigeria</label>
    </div>

  </div>

   

   <div>
        <button type="submit" class="btn btn-primary">Search</button>
    </div>

   <!--<button type="submit"><i class="fa fa-search"></i>-->
   </button>
</form>

<br>
<br>


<center>


<!-- Data is a list of rows (each row is a nested list)-->


<h3>{{SNPtitle}}</h3>



<table class="table">

    <tbody>
        
        {% for header in headings %}
        <td class="font-weight-bold">{{header}}</td>
        {% endfor %}
        
    </tbody>  
    
    <tbody>

        {% for row in data %}
        <tr>
            {% for item in row %}
           
            <td> {{item}} </td>
            
            {% endfor %}
        </tr>
        {% endfor %}

    </tbody>

</table>

<br>
<br>

<h3>{{btitle}}</h3>

<table class="table">

  <tbody>
        
    {% for header in bhead %}
    <td class="font-weight-bold">{{header}}</td>
    {% endfor %}
    
  </tbody>  

  <tbody>

    {% for row in BEB %}
    <tr>
        {% for item in row %}
      
        <td> {{item}} </td>
        
        {% endfor %}
    </tr>
    {% endfor %}

  </tbody>

</table>

<br>

<h3>{{gtitle}}</h3>

<table class="table">

  <tbody>
        
    {% for header in ghead %}
    <td class="font-weight-bold">{{header}}</td>
    {% endfor %}
    
  </tbody>  

  <tbody>

    {% for row in GBR %}
    <tr>
        {% for item in row %}
      
        <td> {{item}} </td>
        
        {% endfor %}
    </tr>
    {% endfor %}

  </tbody>

</table>

<br>
<h3>{{ctitle}}</h3>

<table class="table">

  <tbody>
        
    {% for header in chead %}
    <td class="font-weight-bold">{{header}}</td>
    {% endfor %}
    
  </tbody>  

  <tbody>

    {% for row in CHB %}
    <tr>
        {% for item in row %}
      
        <td> {{item}} </td>
        
        {% endfor %}
    </tr>
    {% endfor %}

  </tbody>

</table>

<br>
<h3>{{ptitle}}</h3>


<table class="table">

  <tbody>
        
    {% for header in phead %}
    <td class="font-weight-bold">{{header}}</td>
    {% endfor %}
    
  </tbody>  

  <tbody>

    {% for row in PEL %}
    <tr>
        {% for item in row %}
      
        <td> {{item}} </td>
        
        {% endfor %}
    </tr>
    {% endfor %}

  </tbody>

</table>

<br>
<h3>{{etitle}}</h3>

<table class="table">

  <tbody>
        
    {% for header in ehead %}
    <td class="font-weight-bold">{{header}}</td>
    {% endfor %}
    
  </tbody>  

  <tbody>

    {% for row in ESN %}
    <tr>
        {% for item in row %}
      
        <td> {{item}} </td>
        
        {% endfor %}
    </tr>
    {% endfor %}

  </tbody>

</table>



</center>


<div class="container text-right" style="padding-right: 50px; padding-top: 50px;">
    <a href="#" id="download" class= "btn btn-danger" > Download! </a>
</div>






{% endblock %}
